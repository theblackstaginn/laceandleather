<!-- index.html (FULL — your exact structure preserved + Google Forms wired) -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>Digital Parchment Textures & Aged Paper Backgrounds | Lace & Leather</title>

  <meta name="description" content="Digital parchment, aged textures, grimoire surfaces, overlays, and ritual map assets for TTRPG creators, designers, and bookbinders." />
  <link rel="canonical" href="https://laceleatherarcane.com/" />

  <!-- Theme / PWA -->
  <meta name="theme-color" content="#0b0f14" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./favicon.png" />
  <link rel="apple-touch-icon" href="./icon-192.png" />

  <!-- Pinterest domain verify -->
  <meta name="p:domain_verify" content="35ebca8082bfd2bfe5109b2afea18305" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Lace & Leather" />
  <meta property="og:title" content="Digital Parchment Textures & Aged Paper Backgrounds | Lace & Leather" />
  <meta property="og:description" content="Digital parchment, aged textures, grimoire surfaces, overlays, and ritual map assets for TTRPG creators, designers, and bookbinders." />
  <meta property="og:url" content="https://laceleatherarcane.com/" />
  <meta property="og:image" content="https://laceleatherarcane.com/assets/og-cover.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Digital Parchment Textures & Aged Paper Backgrounds | Lace & Leather" />
  <meta name="twitter:description" content="Digital parchment, aged textures, grimoire surfaces, overlays, and ritual map assets for TTRPG creators, designers, and bookbinders." />
  <meta name="twitter:image" content="https://laceleatherarcane.com/assets/og-cover.png" />

  <!-- Structured Data (Organization + WebSite) -->
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Organization",
      "@id": "https://laceleatherarcane.com/#organization",
      "name": "Lace & Leather",
      "url": "https://laceleatherarcane.com/",
      "logo": "https://laceleatherarcane.com/assets/l&l_logo.png",
      "sameAs": [
        "https://instagram.com/lace.and.leather65",
        "https://pinterest.com/laceandleather65",
        "https://payhip.com/LaceLeather65",
        "https://www.etsy.com/shop/laceLeatherArcane"
      ]
    },
    {
      "@type": "WebSite",
      "@id": "https://laceleatherarcane.com/#website",
      "url": "https://laceleatherarcane.com/",
      "name": "Lace & Leather",
      "publisher": { "@id": "https://laceleatherarcane.com/#organization" }
    }
  ]
}
  </script>

  <link rel="stylesheet" href="styles.css" />

  <!-- Inline UI wiring styles (no styles.css edits needed) -->
  <style>
    .cart-pay-row{
      display:flex;
      justify-content:center;
      gap:14px;
      flex-wrap:wrap;
      margin-top: 14px;
      align-items:center;
    }

    /* Image-button base (HOME) */
    .ll-home-btn{
      display:inline-block;
      width: 230px;
      height: 74px;
      border:0;
      padding:0;
      background: transparent;
      background-repeat:no-repeat;
      background-position:center;
      background-size:contain;
      cursor:pointer;
      text-decoration:none;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      position:relative;
    }

    /* Keep text accessible but not visible */
    .ll-home-btn .sr-only{
      position:absolute;
      width:1px;height:1px;
      padding:0;margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }

    .ll-home-btn:focus{
      outline:2px solid rgba(255,255,255,.35);
      outline-offset:4px;
      border-radius:10px;
    }

    .ll-cart{ background-image:url("./L&L-buttons/cart.png"); }
    .ll-paypad{ background-image:url("./L&L-buttons/paypad.png"); }

    @media (max-width: 420px){
      .ll-home-btn{ width: 200px; height: 66px; }
    }

    /* ===== Packs: price + button centered UNDER card (sketch style) ===== */
    .pack-wrap{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .pack-buy{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding: 0;
      margin-top: 2px;
      text-align:center;
    }

    .pack-price{
      font-size:14px;
      letter-spacing:.06em;
      text-transform:uppercase;
      opacity:.95;
      line-height:1;
    }

    .ll-add-btn{
      display:inline-block;
      width: 210px;
      height: 68px;
      border:0;
      padding:0;
      background: transparent url("./L&L-buttons/add-to-cart.png") center/contain no-repeat;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .ll-add-btn:focus{
      outline:2px solid rgba(255,255,255,.35);
      outline-offset:4px;
      border-radius:10px;
    }
    @media (max-width: 420px){
      .ll-add-btn{ width: 190px; height: 62px; }
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true"></div>

  <div class="dust" aria-hidden="true">
    <span></span><span></span><span></span><span></span>
    <span></span><span></span><span></span><span></span>
    <span></span><span></span><span></span><span></span>
  </div>

  <main class="wrap">
    <header class="hero">
      <div class="brand-title">Lace &amp; Leather</div>
      <div class="hero-inner">
        <img class="logo" src="./assets/l&l_logo.png" alt="Lace &amp; Leather" />

        <p class="tagline">Digital textures for artists, designers &amp; bookmakers.</p>
        <p class="subtag">Aged parchment · ritual surfaces · dark elegance</p>

        <div class="cart-pay-row" aria-label="Cart and checkout">
          <button class="ll-home-btn ll-cart" type="button" id="cartBtn">
            <span class="sr-only">Cart / Pay</span>
          </button>

          <a class="ll-home-btn ll-paypad" href="./pay.html" rel="noopener noreferrer">
            <span class="sr-only">Open Pay Screen</span>
          </a>
        </div>

        <section id="process" class="glass section" aria-label="Process">
          <h2 class="h2">Process</h2>
          <p class="muted">
            Built like a workshop: stains, fibers, and surface wear — curated so your text stays legible.
          </p>

          <div class="creation-grid" aria-label="Creation photos">
            <img src="./assets/creation/creation_1.png" alt="Creation process photo 1" loading="lazy" />
            <img src="./assets/creation/creation_2.png" alt="Creation process photo 2" loading="lazy" />
            <img src="./assets/creation/creation_3.png" alt="Creation process photo 3" loading="lazy" />
            <img src="./assets/creation/creation_4.png" alt="Creation process photo 4" loading="lazy" />
          </div>

          <p class="shop-line muted">Shop now</p>

          <div class="social-icons" aria-label="Shop and follow">
            <a class="seal" href="https://payhip.com/LaceLeather65" target="_blank" rel="noopener noreferrer" aria-label="Payhip">
              <img src="./assets/social-icons/payhip-icon.PNG" alt="Payhip" />
            </a>

            <a class="seal" href="https://www.etsy.com/shop/laceLeatherArcane" target="_blank" rel="noopener noreferrer" aria-label="Etsy">
              <img src="./assets/social-icons/etsy-icon.PNG" alt="Etsy" />
            </a>

            <a class="seal" href="https://instagram.com/lace.and.leather65" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
              <img src="./assets/social-icons/instagram-icon.PNG" alt="Instagram" />
            </a>

            <a class="seal" href="https://pinterest.com/laceandleather65" target="_blank" rel="noopener noreferrer" aria-label="Pinterest">
              <img src="./assets/social-icons/pinterest-icon.PNG" alt="Pinterest" />
            </a>
          </div>
        </section>
      </div>
    </header>

    <section class="glass section" aria-label="Packs">
      <h2 class="h2">Browse Packs</h2>
      <p class="muted">Tap a cover to preview the full set. Add to cart to buy ($5 each).</p>

      <div class="packs">
        <div class="pack-wrap">
          <button class="pack" type="button" data-pack="grimoire">
            <img src="./assets/grimoire/grim-thumb.png" alt="Grimoire pack preview" loading="lazy" />
            <div class="pack-meta">
              <div class="pack-title">Grimoire Pages</div>
              <div class="pack-note muted">Click to preview all pages</div>
            </div>
          </button>

          <div class="pack-buy" aria-label="Buy Grimoire Pages">
            <div class="pack-price muted">$5.00</div>
            <button class="ll-add-btn" type="button" data-add="grimoire" aria-label="Add Grimoire Pages to cart"></button>
          </div>
        </div>

        <div class="pack-wrap">
          <button class="pack" type="button" data-pack="mapmaker">
            <img src="./assets/mapmaker/mapmaker-cover.png" alt="Mapmaker pack preview" loading="lazy" />
            <div class="pack-meta">
              <div class="pack-title">Mapmaker Sheets</div>
              <div class="pack-note muted">Click to preview all sheets</div>
            </div>
          </button>

          <div class="pack-buy" aria-label="Buy Mapmaker Sheets">
            <div class="pack-price muted">$5.00</div>
            <button class="ll-add-btn" type="button" data-add="mapmaker" aria-label="Add Mapmaker Sheets to cart"></button>
          </div>
        </div>

        <div class="pack-wrap">
          <button class="pack" type="button" data-pack="volone">
            <img src="./assets/vol-one/vol-1-thumbnail.png" alt="Vol One light parchment preview" loading="lazy" />
            <div class="pack-meta">
              <div class="pack-title">Light Aged Parchment — Vol. One</div>
              <div class="pack-note muted">Click to preview all textures</div>
            </div>
          </button>

          <div class="pack-buy" aria-label="Buy Light Aged Parchment Vol One">
            <div class="pack-price muted">$5.00</div>
            <button class="ll-add-btn" type="button" data-add="volone" aria-label="Add Vol One to cart"></button>
          </div>
        </div>
      </div>
      <!-- =========================
     BUTTONS / STICKERS BANNER
     ========================= -->
<section class="wrap">
  <a href="./buttons.html" class="buttons-banner-link" aria-label="Browse fantasy buttons and stickers">
    <img
      src="./assets/button-banner.png"
      alt="Fantasy Buttons & Stickers"
      class="buttons-banner-img"
    />
  </a>
</section>
    </section>

    <!-- MAP COMMISSIONS -->
    <section id="maps" class="glass section section-maps" aria-label="Custom fantasy maps">
      <h2 class="h2">Custom Fantasy Maps</h2>
      <p class="muted">
        Hand-drawn parchment cartography for D&amp;D campaigns, novels, and worldbuilding.
      </p>

      <div class="maps-grid" aria-label="Map examples">
        <figure class="map-card" data-map="suneen" tabindex="0" role="button" aria-label="Preview map: Suneen Reef">
          <div class="map-thumb">
            <img src="./assets/maps/suneen-reef.png" alt="Fantasy map example — Suneen Reef" loading="lazy" />
          </div>
          <figcaption class="map-caption">
            <span class="map-name">Suneen Reef</span>
            <span class="map-tagline">ringed reef &amp; coastal settlements</span>
          </figcaption>
        </figure>

        <figure class="map-card" data-map="whispering" tabindex="0" role="button" aria-label="Preview map: Whispering Bay">
          <div class="map-thumb">
            <img src="./assets/maps/whispering-bay.png" alt="Fantasy map example — Whispering Bay" loading="lazy" />
          </div>
          <figcaption class="map-caption">
            <span class="map-name">Whispering Bay</span>
            <span class="map-tagline">shadowed shores &amp; hidden coves</span>
          </figcaption>
        </figure>
      </div>

      <div class="maps-copy">
        <p>
          Islands, regions, and towns illustrated on aged parchment with custom coastlines, labels, and compasses —
          tuned for print and digital campaigns alike.
        </p>
        <p><strong>Deliverables:</strong> High-resolution PNG/JPG, print-ready at 300 DPI, optional transparent background.</p>
        <p><strong>Availability:</strong> 3 custom map slots open each month.</p>
      </div>

      <p class="maps-ward muted">
        Protection ward: previews stay here. No reuse, resale, or training data. Full-resolution files are delivered privately to clients.
      </p>

      <div class="maps-cta">
        <button class="maps-btn" type="button" id="openCommission">
          <img class="wax-seal-img" src="./assets/custom-maps-button.png" alt="Request a custom map slot" />
        </button>
      </div>
    </section>

    <section class="section section-copy">
      <h2>Digital aged parchment textures for designers, authors &amp; bookmakers</h2>
      <p>
        Lace &amp; Leather creates <strong>digital parchment textures</strong> for artists, writers,
        bookbinders, and TTRPG creators. Every page is built as a high-resolution
        <strong>printable vintage paper</strong> file you can drop straight into your layouts
        for journals, notebooks, book interiors, spellbooks, and campaign logs.
      </p>
      <p>
        Packs are designed for <strong>commercial use</strong> and tested across common
        workflows: <strong>scrapbooking &amp; journaling</strong>, bookbinding and
        <strong>book arts</strong>, fantasy <strong>TTRPG map-making</strong>, tarot
        and oracle decks, and digital collages. Use them as <strong>aged paper backgrounds</strong>,
        subtle <strong>graphic design overlays</strong>, or full printable pages for DIY projects.
      </p>
      <p>
        If you need believable, high-detail parchment that prints cleanly and works
        with layered designs, these <strong>digital textures</strong> were built for you.
        No stock-photo noise, no fake grunge — just consistent, archival-feeling pages that make your work look like it has a history.
      </p>
    </section>

    <footer class="site-footer">
      <p class="footer-sub">
        Website by
        <a href="https://blackstagweb.com" rel="noopener noreferrer">Black Stag Web Studio</a>
      </p>
      <div class="footer-inner">
        <div class="brand">Lace &amp; Leather</div>
        <div class="muted">Digital texture packs · PNG/JPG · Instant delivery via shop links</div>
      </div>
    </footer>
  </main>

  <!-- =========================================================
       MODALS (Pack Preview + Map Preview + Commission Flow)
       Matches your existing styles.css classes and repo filenames
       ========================================================= -->

  <!-- PACK PREVIEW MODAL -->
  <div class="modal" id="packModal" aria-hidden="true" role="dialog" aria-label="Pack preview">
    <div class="modal-backdrop" data-close></div>

    <div class="glass modal-panel" role="document">
      <div class="modal-head">
        <div class="modal-left">
          <div>
            <div class="modal-title" id="packModalTitle">Preview</div>
            <div class="modal-sub muted" id="packModalSub">Tap any page to enlarge</div>
          </div>
        </div>

        <div class="modal-actions">
          <!-- Back (only shows in viewer mode via CSS) -->
          <button class="wax-btn back-btn" type="button" id="packBackBtn" aria-label="Back to grid">
            <img src="./assets/back-button.PNG" alt="Back" />
          </button>

          <!-- Close -->
          <button class="wax-btn" type="button" data-close aria-label="Close">
            <img src="./assets/x-button.PNG" alt="Close" />
          </button>
        </div>
      </div>

      <div class="modal-body">
        <div class="collage" id="packCollage" aria-label="Pack collage"></div>

        <div class="viewer" id="packViewer" aria-label="Viewer">
          <div class="viewer-img" id="packViewerImg" aria-hidden="true"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- MAP PREVIEW MODAL -->
  <div class="modal" id="mapModal" aria-hidden="true" role="dialog" aria-label="Map preview">
    <div class="modal-backdrop" data-close></div>

    <div class="glass modal-panel" role="document">
      <div class="modal-head">
        <div class="modal-left">
          <div>
            <div class="modal-title" id="mapModalTitle">Map Preview</div>
            <div class="modal-sub muted" id="mapModalSub">Preview stays here</div>
          </div>
        </div>

        <div class="modal-actions">
          <button class="wax-btn" type="button" data-close aria-label="Close">
            <img src="./assets/x-button.PNG" alt="Close" />
          </button>
        </div>
      </div>

      <div class="modal-body">
        <div class="viewer" style="display:block;">
          <div class="viewer-img" id="mapViewerImg" aria-hidden="true"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- COMMISSION: ENVELOPE MODAL (full-screen style per CSS) -->
  <div class="modal" id="commissionModal" aria-hidden="true" role="dialog" aria-label="Commission request">
    <div class="modal-backdrop" data-close></div>

    <div class="commission-panel" role="document">
      <div class="commission-inner">
        <div class="commission-bg" aria-hidden="true"></div>

        <button class="commission-close wax-btn" type="button" data-close aria-label="Close">
          <img src="./assets/x-button.PNG" alt="Close" />
        </button>

        <button class="commission-envelope-btn" type="button" id="openLetter" aria-label="Open envelope">
          <img class="commission-envelope-img" src="./commission-modal-assets/envelope-closed.png" alt="Envelope" />
        </button>
      </div>
    </div>
  </div>

  <!-- COMMISSION: LETTER MODAL -->
  <div class="modal" id="letterModal" aria-hidden="true" role="dialog" aria-label="Commission letter">
    <div class="modal-backdrop" data-close></div>

    <div class="glass modal-panel letter-panel" role="document">
      <div class="modal-head">
        <div class="modal-left">
          <div>
            <div class="modal-title">Commission Letter</div>
            <div class="modal-sub muted">Map slots open monthly</div>
          </div>
        </div>

        <div class="modal-actions">
          <button class="wax-btn" type="button" data-close aria-label="Close">
            <img src="./assets/x-button.PNG" alt="Close" />
          </button>
        </div>
      </div>

      <div class="letter-body">
        <div class="letter-bg" aria-hidden="true"></div>

        <div class="letter-stack">
          <img class="letter-img" src="./commission-modal-assets/commission-letter.png" alt="Commission letter" />

          <!-- Map Slot button (NOW WIRED to Google Form) -->
          <button class="map-slot-btn" type="button" id="mapSlotBtn" aria-label="Request a map slot">
            <img src="./commission-modal-assets/map-slot-button.png" alt="Map Slot" />
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- =========================================================
       JS: Cart wiring + Pack preview + Map preview + Commission flow
       Uses your pay.html keys exactly: ll_cart + ll_order_id
       PLUS: wires your two Google Forms
       ========================================================= -->
  <script>
    // -----------------------------
    // Google Forms (YOUR LINKS)
    // -----------------------------
    const MAP_COMMISSION_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSdIVLZ8Nc4GXj5fNdUfKc2dVX0Vo2flcQrCERJiPgeL6qHaOg/viewform?usp=header";
    const CONFIRM_ORDER_FORM_URL  = "https://docs.google.com/forms/d/e/1FAIpQLSdvh4sgUyHin-EeEdrreMRES-Ah1KbDafmRfiDVcODj7ZKzPg/viewform?usp=header";

    // -----------------------------
    // Storage keys (MUST MATCH pay.html)
    // -----------------------------
    const CART_KEY  = "ll_cart";     // array of {name, price, qty}
    const ORDER_KEY = "ll_order_id"; // string

    // -----------------------------
    // Helpers
    // -----------------------------
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    function safeParse(json, fallback){
      try { return JSON.parse(json) ?? fallback; } catch { return fallback; }
    }

    function loadCart(){
      const raw = localStorage.getItem(CART_KEY);
      const cart = safeParse(raw, []);
      return Array.isArray(cart) ? cart : [];
    }

    function saveCart(cart){
      localStorage.setItem(CART_KEY, JSON.stringify(cart));
    }

    function genOrderId(){
      const a = Math.random().toString(16).slice(2,6).toUpperCase();
      const b = Math.random().toString(16).slice(2,6).toUpperCase();
      return `${a}-${b}`;
    }

    function ensureOrderId(){
      let id = localStorage.getItem(ORDER_KEY);
      if(!id){
        id = genOrderId();
        localStorage.setItem(ORDER_KEY, id);
      }
      return id;
    }

    function calcSubtotal(cart){
      let subtotal = 0;
      for(const item of cart){
        const qty  = Math.max(1, Number(item?.qty ?? 1));
        const price = Number(item?.price ?? 0);
        subtotal += (price * qty);
      }
      return Number(subtotal.toFixed(2));
    }

    function addToCart(item){
      // item: {name, price}
      const cart = loadCart();
      const existing = cart.find(x => String(x?.name) === item.name);
      if(existing){
        existing.qty = Math.max(1, Number(existing.qty || 1) + 1);
      }else{
        cart.push({ name: item.name, price: Number(item.price || 0), qty: 1 });
      }
      saveCart(cart);
      ensureOrderId(); // keep order id stable once cart has items
    }

    // -----------------------------
    // Product map (names shown on pay.html)
    // -----------------------------
    const PRODUCT = {
      grimoire: { name: "Grimoire Pages", price: 5.00 },
      mapmaker: { name: "Mapmaker Sheets", price: 5.00 },
      volone:   { name: "Light Aged Parchment — Vol. One", price: 5.00 }
    };

    // -----------------------------
    // HOME BUTTONS
    // -----------------------------
    $("#cartBtn")?.addEventListener("click", () => {
      // "Cart" takes them to pay screen (your flow)
      window.location.href = "./pay.html";
    });

    // Add-to-cart buttons (PNG)
    $$("button.ll-add-btn[data-add]").forEach(btn => {
      btn.addEventListener("click", () => {
        const key = btn.getAttribute("data-add");
        const p = PRODUCT[key];
        if(!p) return;
        addToCart(p);
        btn.blur();
      });
    });

    // -----------------------------
    // PACK PREVIEW MODAL
    // -----------------------------
    const packModal      = $("#packModal");
    const packTitle      = $("#packModalTitle");
    const packSub        = $("#packModalSub");
    const packCollage    = $("#packCollage");
    const packViewerImg  = $("#packViewerImg");
    const packBackBtn    = $("#packBackBtn");

    const PACKS = {
      grimoire: {
        title: "Grimoire Pages",
        sub: "Preview (12 pages)",
        images: Array.from({length: 12}, (_,i)=> `./assets/grimoire/grim-${i+1}.PNG`)
      },
      mapmaker: {
        title: "Mapmaker Sheets",
        sub: "Preview (10 sheets)",
        images: [
          "./assets/mapmaker/map_3.png",
          "./assets/mapmaker/map_4.png",
          "./assets/mapmaker/map_5.png",
          "./assets/mapmaker/map_6.png",
          "./assets/mapmaker/map_7.png",
          "./assets/mapmaker/map_8.png",
          "./assets/mapmaker/map_9.png",
          "./assets/mapmaker/map_10.png",
          "./assets/mapmaker/map_12.png",
          "./assets/mapmaker/map_13.png"
        ]
      },
      volone: {
        title: "Light Aged Parchment — Vol. One",
        sub: "Preview (12 textures)",
        images: Array.from({length: 12}, (_,i)=> `./assets/vol-one/parchment-light_${i+1}.jpg`)
      }
    };

    function openModal(el){
      el.classList.add("open");
      el.setAttribute("aria-hidden", "false");
      document.documentElement.classList.add("no-scroll");
    }

    function closeModal(el){
      el.classList.remove("open");
      el.setAttribute("aria-hidden", "true");
      document.documentElement.classList.remove("no-scroll");
    }

    function setPackModeViewer(isViewer){
      packModal.classList.toggle("mode-viewer", !!isViewer);
    }

    function buildPackCollage(images){
      packCollage.innerHTML = "";
      images.forEach((src, idx) => {
        const tile = document.createElement("button");
        tile.type = "button";
        tile.className = "tile";
        tile.setAttribute("aria-label", `Open preview ${idx+1}`);
        tile.innerHTML = `
          <div class="tile-face" style="background-image:url('${src}')"></div>
          <div class="tile-shield" aria-hidden="true"></div>
        `;
        tile.addEventListener("click", () => {
          packViewerImg.style.backgroundImage = `url('${src}')`;
          setPackModeViewer(true);
        });
        packCollage.appendChild(tile);
      });
    }

    $$("button.pack[data-pack]").forEach(btn => {
      btn.addEventListener("click", () => {
        const key = btn.getAttribute("data-pack");
        const def = PACKS[key];
        if(!def) return;

        packTitle.textContent = def.title;
        packSub.textContent = def.sub;
        buildPackCollage(def.images);

        packViewerImg.style.backgroundImage = "";
        setPackModeViewer(false);

        openModal(packModal);
      });
    });

    packBackBtn?.addEventListener("click", () => {
      setPackModeViewer(false);
      packViewerImg.style.backgroundImage = "";
    });

    // -----------------------------
    // MAP PREVIEW MODAL
    // -----------------------------
    const mapModal      = $("#mapModal");
    const mapModalTitle = $("#mapModalTitle");
    const mapModalSub   = $("#mapModalSub");
    const mapViewerImg  = $("#mapViewerImg");

    const MAPS = {
      suneen: {
        title: "Suneen Reef",
        sub: "Preview stays here",
        src: "./assets/maps/suneen-reef.png"
      },
      whispering: {
        title: "Whispering Bay",
        sub: "Preview stays here",
        src: "./assets/maps/whispering-bay.png"
      }
    };

    function openMap(key){
      const def = MAPS[key];
      if(!def) return;
      mapModalTitle.textContent = def.title;
      mapModalSub.textContent = def.sub;
      mapViewerImg.style.backgroundImage = `url('${def.src}')`;
      openModal(mapModal);
    }

    $$(".map-card[data-map]").forEach(card => {
      const key = card.getAttribute("data-map");
      card.addEventListener("click", () => openMap(key));
      card.addEventListener("keydown", (e) => {
        if(e.key === "Enter" || e.key === " "){
          e.preventDefault();
          openMap(key);
        }
      });
    });

    // -----------------------------
    // COMMISSION FLOW
    // -----------------------------
    const commissionModal = $("#commissionModal");
    const letterModal     = $("#letterModal");
    const openCommission  = $("#openCommission");
    const openLetter      = $("#openLetter");

    openCommission?.addEventListener("click", () => openModal(commissionModal));
    openLetter?.addEventListener("click", () => {
      closeModal(commissionModal);
      openModal(letterModal);
    });

    // Map Slot button -> opens Google Form (new tab)
    $("#mapSlotBtn")?.addEventListener("click", () => {
      window.open(MAP_COMMISSION_FORM_URL, "_blank", "noopener,noreferrer");
    });

    // -----------------------------
    // Confirm Order Form helper (OPTIONAL use later)
    // This DOES NOT run automatically here (pay.html handles confirm),
    // but it gives you a clean function to call from pay.html if you want.
    // -----------------------------
    function buildConfirmOrderPrefillUrl(){
      const cart = loadCart();
      const orderId = ensureOrderId();
      const subtotal = calcSubtotal(cart);

      // NOTE: For prefill to work, you must replace these with your form entry IDs:
      //   entry.1234567890 = Order ID
      //   entry.2345678901 = Subtotal
      //   entry.3456789012 = Items (text)
      // Until you add entry IDs, this returns the base form URL.
      const ENTRY = {
        orderId: null,
        subtotal: null,
        items: null
      };

      const itemsText = cart.map(it => {
        const name = String(it?.name ?? "Item");
        const qty  = Math.max(1, Number(it?.qty ?? 1));
        const price = Number(it?.price ?? 0);
        return `${name} x${qty} — $${(price*qty).toFixed(2)}`;
      }).join("\n");

      const u = new URL(CONFIRM_ORDER_FORM_URL);

      // Only append if you set entry IDs
      if(ENTRY.orderId)  u.searchParams.set(ENTRY.orderId, orderId);
      if(ENTRY.subtotal) u.searchParams.set(ENTRY.subtotal, subtotal.toFixed(2));
      if(ENTRY.items)    u.searchParams.set(ENTRY.items, itemsText);

      return u.toString();
    }

    // Expose helpers if you ever want to call from other scripts
    window.LL_FORMS = {
      MAP_COMMISSION_FORM_URL,
      CONFIRM_ORDER_FORM_URL,
      buildConfirmOrderPrefillUrl
    };

    // -----------------------------
    // GLOBAL CLOSE HANDLERS
    // -----------------------------
    $$("[data-close]").forEach(el => {
      el.addEventListener("click", () => {
        const modal = el.closest(".modal");
        if(modal) closeModal(modal);
      });
    });

    document.addEventListener("keydown", (e) => {
      if(e.key !== "Escape") return;
      const open = $$(".modal.open");
      if(!open.length) return;
      closeModal(open[open.length - 1]);
    });

    // Boot: order id is created on first add-to-cart (not on page load)
  </script>
</body>
</html>